<ion-header [hidden]="scanActive">
  <ion-toolbar color="dark">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" color="danger"></ion-back-button>
    </ion-buttons>
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [style.--background]="scanActive ? '#00000000' : urlFondo">

  <div [hidden]="scanActive" class="contenedor ion-margin">
    <ion-button [hidden]="scanActive" color="danger" shape="round" fill="outline" expand="full" (click)="escanearQr()" type="button" class="ion-margin" >Escanear DNI<ion-icon slot="start" name="qr-code-outline"></ion-icon></ion-button>
    <div class="divImage" [hidden]="scanActive">
      <ion-avatar class="avatarImage">
        <img [src]='foto' alt="">
      </ion-avatar>
    </div>

    <ion-button color="danger" shape="round" fill="outline" expand="full" (click)="tomarFoto()" type="button" class="ion-margin" ><p>Tomar foto</p><ion-icon slot="start" name="camera-outline"></ion-icon></ion-button>

    <form [hidden]="scanActive" id="form" [formGroup]="altaForm" (ngSubmit)="alta(altaForm)">

    <ion-item class="ion-margin-bottom ion-margin-top">
      <ion-icon name="person-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="apellido" [value]='apellidoStr' placeholder="Apellidos"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.apellido">
      <ng-container *ngIf="apellido.hasError(error.type) && (apellido.dirty || apellido.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-item class="ion-margin-bottom">
      <ion-icon name="person-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="nombre" [value]='nombreStr' placeholder="Nombres"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.nombre">
      <ng-container *ngIf="nombre.hasError(error.type) && (nombre.dirty || nombre.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-item class="ion-margin-bottom">
      <ion-icon name="card-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="dni" [value]='dniStr' placeholder="DNI" maxlength="8"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.dni">
      <ng-container *ngIf="dni.hasError(error.type) && (dni.dirty || dni.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-item class="ion-margin-bottom">
      <ion-icon name="mail-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="email" placeholder="Correo"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.email">
      <ng-container *ngIf="email.hasError(error.type) && (email.dirty || email.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-item class="ion-margin-bottom">
      <ion-icon name="key-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="password" type="password" placeholder="Contraseña"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.password">
      <ng-container *ngIf="password.hasError(error.type) && (password.dirty || password.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-item class="ion-margin-bottom">
      <ion-icon name="key-outline" color="danger" slot="start"></ion-icon>
      <ion-input formControlName="passwordConfirm" type="password" placeholder="Confirmar contraseña"></ion-input>
    </ion-item>
    <div *ngFor="let error of errorMessages.passwordConfirm">
      <ng-container *ngIf="passwordConfirm.hasError(error.type) && (passwordConfirm.dirty || passwordConfirm.touched)">
        <small class="error-message">{{error.message}}</small>
      </ng-container>
    </div><br>

    <ion-button color="danger" shape="round" expand="full" style="margin-bottom: 20px;" type="submit" >
      <ion-icon slot="start" name="reader-outline"></ion-icon>
      Registrarse</ion-button>
    </form>

  </div>


  <!-- Aparece cuando el scanner esta activado-->
  <div class="scan-box" [hidden]="!scanActive"></div>
  <ion-row class="scanner-buttons" [hidden]="!scanActive">
    <ion-col class="ion-no-padding">
      <ion-button (click)="stopScanner()" color="danger" shape="round" expand="full">Salir</ion-button>
    </ion-col>
  </ion-row>

</ion-content>